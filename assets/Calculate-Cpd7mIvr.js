import"./index-BciqUSOs.js";import{a as g}from"./index-DW_MHI2K.js";import{_ as W,r as i,p as X,e as d,w as t,b as n,o as s,f as l,q as v,i as c,l as r,h as T,F as B,j as N,t as _}from"./index-erCPS4Xs.js";const Y={__name:"Calculate",setup(Z){const a=i({targetFunctions:[],optimizationAlgorithm:"",iterationCount:50,populationSize:10}),z=i(null),f=i(0),A=i(!1),b=i(null),y=i(null),S=o=>new Date(o).toLocaleString(),H=async()=>{if(a.value.targetFunctions.length===0){alert("请选择至少一个优化目标！");return}b.value=new Date,A.value=!0,f.value=0;const o=await g.get("http://localhost:8080/enumerate");console.log(o.data)},F=async()=>{try{const o=await g.get("http://localhost:8080/progress");f.value=o.data.progress,f.value>=100?(A.value=!1,y.value=new Date,z.value="计算完成,请到结果分析页面查看计算结果。"):setTimeout(F,1e3)}catch(o){console.error("获取进度失败:",o)}},O=async()=>{try{const o=await g.get("http://localhost:8080/stop_enumerate");console.log(o.data)}catch(o){console.error("停止计算失败:",o)}},k=i([{key:"step1",label:"风电",num:5},{key:"step2",label:"光伏",num:5},{key:"step3",label:"储能",num:5},{key:"step4",label:"电解槽",num:5},{key:"step5",label:"储氢罐",num:1}]),U=i({}),E=()=>{const o={};return k.value.forEach(e=>{o[e.key]=e.num}),o};X(()=>k.value,()=>{U.value=E(),P()},{deep:!0});const P=async()=>{try{const o=await g.post("http://localhost:8080/setsteps",{steps:U.value});console.log(o.data)}catch(o){console.error("设置参数失败:",o),alert("设置参数失败，请检查输入参数是否正确！")}};return(o,e)=>{const V=n("el-checkbox"),j=n("el-checkbox-group"),m=n("el-card"),h=n("el-radio"),q=n("el-radio-group"),C=n("el-input-number"),x=n("el-form-item"),D=n("el-form"),w=n("el-button"),L=n("el-col"),I=n("el-progress"),G=n("el-tag"),p=n("el-descriptions-item"),J=n("el-descriptions"),K=n("el-row"),M=n("el-main"),Q=n("el-container");return s(),d(Q,null,{default:t(()=>[l(M,null,{default:t(()=>[l(K,{gutter:20},{default:t(()=>[l(L,{span:12},{default:t(()=>[l(m,{class:"form-card"},{default:t(()=>[e[7]||(e[7]=c("h2",null,"选择优化目标",-1)),l(j,{modelValue:a.value.targetFunctions,"onUpdate:modelValue":e[0]||(e[0]=u=>a.value.targetFunctions=u)},{default:t(()=>[l(V,{value:"LCOH",label:"LCOH"},{default:t(()=>e[4]||(e[4]=[r("LCOH")])),_:1}),l(V,{value:"风光消纳率",label:"风光消纳率"},{default:t(()=>e[5]||(e[5]=[r("风光消纳率")])),_:1}),l(V,{value:"产氢量",label:"产氢量"},{default:t(()=>e[6]||(e[6]=[r("产氢量")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(m,{class:"form-card"},{default:t(()=>[e[10]||(e[10]=c("h2",null,"选择优化算法",-1)),l(q,{modelValue:a.value.optimizationAlgorithm,"onUpdate:modelValue":e[1]||(e[1]=u=>a.value.optimizationAlgorithm=u)},{default:t(()=>[l(h,{value:"geneticAlgorithm"},{default:t(()=>e[8]||(e[8]=[r("遗传算法")])),_:1}),l(h,{value:"enumeration"},{default:t(()=>e[9]||(e[9]=[r("枚举法")])),_:1})]),_:1},8,["modelValue"])]),_:1}),a.value.optimizationAlgorithm==="geneticAlgorithm"?(s(),d(m,{key:0,class:"form-card"},{default:t(()=>[e[11]||(e[11]=c("h2",null,"遗传算法参数设置",-1)),l(D,{model:a.value,"label-width":"120px"},{default:t(()=>[l(x,{label:"迭代次数"},{default:t(()=>[l(C,{modelValue:a.value.iterationCount,"onUpdate:modelValue":e[2]||(e[2]=u=>a.value.iterationCount=u),min:1,max:1e3},null,8,["modelValue"])]),_:1}),l(x,{label:"种群大小"},{default:t(()=>[l(C,{modelValue:a.value.populationSize,"onUpdate:modelValue":e[3]||(e[3]=u=>a.value.populationSize=u),min:1,max:1e3},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})):v("",!0),a.value.optimizationAlgorithm==="enumeration"?(s(),d(m,{key:1,class:"form-card"},{default:t(()=>[e[12]||(e[12]=c("h2",null,"枚举法计算步长设置",-1)),l(D,{"label-width":"120px"},{default:t(()=>[(s(!0),T(B,null,N(k.value,u=>(s(),d(x,{key:u.label,label:u.label},{default:t(()=>[l(C,{modelValue:u.num,"onUpdate:modelValue":R=>u.num=R,min:0,class:"enumeration-input"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"]))),128))]),_:1})]),_:1})):v("",!0),l(m,{class:"form-card"},{default:t(()=>[e[16]||(e[16]=c("h2",null,"开始计算",-1)),l(w,{type:"primary",onClick:H},{default:t(()=>e[13]||(e[13]=[r("开始计算")])),_:1}),l(w,{type:"primary",onClick:F},{default:t(()=>e[14]||(e[14]=[r("计算进度")])),_:1}),l(w,{type:"primary",onClick:O},{default:t(()=>e[15]||(e[15]=[r("停止计算")])),_:1})]),_:1})]),_:1}),l(L,{span:12},{default:t(()=>[l(m,{class:"form-card"},{default:t(()=>[e[17]||(e[17]=c("h2",null,"计算进度",-1)),l(I,{percentage:f.value,status:"success"},null,8,["percentage"])]),_:1}),l(m,{class:"form-card"},{default:t(()=>[e[18]||(e[18]=c("h2",null,"计算结果",-1)),l(J,{column:1,border:""},{default:t(()=>[l(p,{label:"优化目标"},{default:t(()=>[(s(!0),T(B,null,N(a.value.targetFunctions,u=>(s(),d(G,{key:u,style:{"margin-right":"5px"}},{default:t(()=>[r(_(u),1)]),_:2},1024))),128))]),_:1}),l(p,{label:"优化算法"},{default:t(()=>[r(_(a.value.optimizationAlgorithm),1)]),_:1}),a.value.optimizationAlgorithm==="geneticAlgorithm"?(s(),d(p,{key:0,label:"迭代次数"},{default:t(()=>[r(_(a.value.iterationCount),1)]),_:1})):v("",!0),a.value.optimizationAlgorithm==="geneticAlgorithm"?(s(),d(p,{key:1,label:"种群大小"},{default:t(()=>[r(_(a.value.populationSize),1)]),_:1})):v("",!0),l(p,{label:"计算开始时间"},{default:t(()=>[r(_(b.value?S(b.value):"未开始"),1)]),_:1}),l(p,{label:"计算结束时间"},{default:t(()=>[r(_(y.value?S(y.value):"未完成"),1)]),_:1}),l(p,{label:"计算结果"},{default:t(()=>[r(_(z.value||"未完成"),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}},le=W(Y,[["__scopeId","data-v-43e212f3"]]);export{le as default};
